# Gommander

Burp Commander written in Go

## Endpoints 

Base URL: `http://127.0.0.1:1337/v0.1/`

### Issue definitions

```bash
curl -X GET $ENDPOINT/knowledge_base/issue_definitions
```

```json
[
  {
    "issue_type_id": "1048832",
    "name": "OS command injection",
    "description": "<p>Operating system command injection vulnerabilities arise when an application incorporates user-controllable data into a command that is processed by a shell command interpreter. [...] The exact potential for exploitation depends upon the security context in which the command is executed, and the privileges that this context has regarding sensitive resources on the server.</p>",
    "remediation": "<p>If possible, applications should avoid incorporating user-controllable data into operating system commands. [...]This defense can mitigate the impact of an attack even in the event that an attacker circumvents the input validation defenses.</li>\n</ul>",
    "vulnerability_classifications": "<ul>\n<li><a href=\"https://cwe.mitre.org/data/definitions/77.html\">CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')</a></li>\n<li><a href=\"https://cwe.mitre.org/data/definitions/78.html\">CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')</a></li>\n<li><a href=\"https://cwe.mitre.org/data/definitions/116.html\">CWE-116: Improper Encoding or Escaping of Output</a></li>\n</ul>"
  },
    [...]
{
    "issue_type_id": "16778240",
    "name": "Mixed content",
    "description": "<p>The application loads pages over HTTPS that load other resources over unencrypted connections. [...] Note that an advanced adversary could potentially target any connection made over the Internet's core infrastructure.</p>",
    "remediation": "<p>Ensure that all external resources the page references are loaded using HTTPS.</p>",
    "references": "<ul>\n<li><a href=\"https://developer.mozilla.org/en/docs/Security/MixedContent\">Mixed Content</a></li>\n</ul>",
    "vulnerability_classifications": "<ul>\n<li><a href=\"https://cwe.mitre.org/data/definitions/16.html\">CWE-16: Configuration</a></li>\n<li><a href=\"https://cwe.mitre.org/data/definitions/319.html\">CWE-319: Cleartext Transmission of Sensitive Information</a></li>\n</ul>"
  },
  {
    "issue_type_id": "134217728",
    "name": "Extension generated issue",
    "description": "<p>This type of issue is used for custom issues that are generated by Burp Suite extensions.</p>"
  }
]
```

### Scans

+ Example:

```bash
curl -X POST $ENDPOINT/scan -d '{"urls":["value1.com","value2.com"]}'
```


+ Request

```http
POST /v0.1/scan HTTP/1.1
Host: 127.0.0.1:1337
User-Agent: curl/7.52.1
Accept: */*
Content-Length: 27
Content-Type: application/x-www-form-urlencoded

{"urls":["test.com"]}
```

+ Response

```http
HTTP/1.1 201 Created
Content-Security-Policy: default-src 'self'; script-src 'self'; img-src 'self'; style-src 'self'; frame-src 'self'; connect-src 'self' ws://localhost:3333; font-src 'self'; media-src 'self'; object-src 'none'; child-src 'self' blob:
X-XSS-Protection: 1; mode=block
X-Content-Type-Options: nosniff
X-Burp-Version: 2.0.06beta-125
X-Frame-Options: DENY
Location: 7
Content-Length: 0
```

The header `Location: #` indicates where the scan is located.

### Get Scan

```bash
curl -X GET $ENDPOING/scan/7
```

+ Request

```http
GET /v0.1/scan/7 HTTP/1.1
Host: 127.0.0.1:1337
User-Agent: curl/7.52.1
Accept: */*
```

+ Response

```http
HTTP/1.1 200 OK
Content-Security-Policy: default-src 'self'; script-src 'self'; img-src 'self'; style-src 'self'; frame-src 'self'; connect-src 'self' ws://localhost:3333; font-src 'self'; media-src 'self'; object-src 'none'; child-src 'self' blob:
X-Content-Type-Options: nosniff
X-XSS-Protection: 1; mode=block
X-Burp-Version: 2.0.06beta-125
X-Frame-Options: DENY
Content-Type: application/json; charset=utf-8
Content-Length: 273
```

```json
{
  "task_id": "7",
  "scan_status": "succeeded",
  "scan_metrics": {
    "crawl_requests_made": 12,
    "crawl_requests_queued": 0,
    "audit_queue_items_completed": 2,
    "audit_queue_items_waiting": 0,
    "audit_requests_made": 1254,
    "audit_network_errors": 126,
    "issue_events": 0
  },
  "message": "",
  "issue_events": []
}
```